<!DOCTYPE html>

<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Prim算法 &#8212; Furo</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pied-piper-admonition.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="动态规划" href="dp/index.html" />
    <link rel="prev" title="Kruskal算法" href="002union_find_kruskal.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="prim">
<h1>Prim算法<a class="headerlink" href="#prim" title="此标题的永久链接">¶</a></h1>
<p>Prim算法是一种常用的最小生成树算法，用于在给定无向连通图中找到最小生成树。最小生成树是一个连通子图，它包含了原图的所有顶点，并且具有最小的总权重或代价。</p>
<p>Prim算法的基本思想是从一个初始顶点开始，逐步地选择与当前最小生成树集合相连的最小权重边，并将其添加到最小生成树中。它的步骤如下：</p>
<ol class="arabic simple">
<li><p>选择一个初始顶点，将其加入最小生成树集合。</p></li>
<li><p>从已选择的顶点集合中找到与之相连的边，并选择权重最小的边。</p></li>
<li><p>将选择的边加入最小生成树集合，并将该边的另一个顶点加入已选择的顶点集合。</p></li>
<li><p>重复步骤2和步骤3，直到最小生成树集合中包含了所有顶点（或边的数量达到了顶点数减1）。</p></li>
</ol>
<p>Prim算法使用一个优先队列（通常是最小堆）来选择权重最小的边。在每一步中，它选择与当前最小生成树集合相连的顶点中具有最小权重的边。这保证了每次选择的边都是当前最小生成树集合和未选择顶点集合之间的最小权重边。</p>
<p>通过使用Prim算法，我们可以在一个连通图中找到一棵最小生成树，该树具有最小的总权重或代价。这在许多应用中都是有用的，如网络设计、电力传输、城市规划等。</p>
<section id="leetcode-1584">
<h2>leetcode 1584. 连接所有点的最小费用<a class="headerlink" href="#leetcode-1584" title="此标题的永久链接">¶</a></h2>
<p>给你一个points 数组，表示 2D 平面上的一些点，其中 points[i] = [xi, yi] 。</p>
<p>连接点 [xi, yi] 和点 [xj, yj] 的费用为它们之间的 曼哈顿距离 ：|xi - xj| + |yi - yj| ，其中 |val| 表示 val 的绝对值。</p>
<p>请你返回将所有点连接的最小总费用。只有任意两点之间 有且仅有 一条简单路径时，才认为所有点都已连接。</p>
</section>
<section id="id1">
<h2>题解<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<section id="prim-0">
<h3>1. 确认初始顶点，Prim算法并没有规定初始点怎么选，这里可以任选，默认取索引为0的点<a class="headerlink" href="#prim-0" title="此标题的永久链接">¶</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// 所有顶点，n×2的二维数组，每行记录了点的坐标</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">points</span><span class="p">;</span>

<span class="c1">// 辅助数组，表示每个点是否已经被确认为已连接，避免重复搜索</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">connected</span><span class="p">(</span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="c1">// 用索引来表示所有的点，初始确认连接的点为0</span>
<span class="c1">// 你要设为其它索引作为其实点也行，反正最后都要连上的</span>
<span class="kt">int</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// 初始顶点已连接</span>
<span class="n">connected</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="c1">// 初始顶点已连接</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<span class="n">path</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">start_index</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>2. 确认下一个连接点，在当前已经确定的点中查找最小边来确认新的点<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h3>
<section id="id3">
<h4>2.1 曼哈顿距离计算，这一步可以提前算好存到一个预计算距离数组中，以便提升程序执行速度（空间换时间）<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h4>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// 计算曼哈顿距离</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">Distance</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">indexA</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">indexB</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">indexA</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">points</span><span class="p">[</span><span class="n">indexB</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">indexA</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">points</span><span class="p">[</span><span class="n">indexB</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>

<span class="c1">// 存了所有坐标点距离的邻接矩阵缓存</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">;</span>

<span class="c1">// 预计算所有坐标点的距离</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">CalcAllDistance</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Distance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id4">
<h4>2.2 在已连接的点集中查找最小边<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h4>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">total_cost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// 最小总费用</span>

<span class="c1">// 查找最小边</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">FindMinEdge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">min_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">;</span><span class="w"> </span><span class="c1">// 下一个最小边</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">min_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 下一个连接最小边的点</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// 查找最小边</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">pt</span><span class="o">:</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 排除和自己连接 &amp;&amp; 排除已连接 &amp;&amp; 最小距离</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">pt</span><span class="o">!=</span><span class="n">i</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">connected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="o">&lt;</span><span class="n">min_edge</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">min_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">                </span><span class="n">min_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 找到最小边后更新总费用和已连接数列</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">min_point</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">min_edge</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">min_point</span><span class="p">);</span>
<span class="w">        </span><span class="n">connected</span><span class="p">[</span><span class="n">min_point</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">total_cost</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">min_edge</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id5">
<h4>2.3 确认全部最小路径<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h4>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// 查找确认最小路径</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">FindMinEdge</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="o-n-3">
<h3>3. 优化，上面的时间复杂度已经达到O(n^3)级别了，执行速度有点一言难尽<a class="headerlink" href="#o-n-3" title="此标题的永久链接">¶</a></h3>
<section id="min-cost">
<h4>3.1 这里增加一个min_cost数组用来存剩余节点距离当前节点的最短距离<a class="headerlink" href="#min-cost" title="此标题的永久链接">¶</a></h4>
<p>当前只有起始节点一个节点的时候很好理解，min_cost空间复杂度为O(n)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// 最短距离</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">min_cost</span><span class="p">(</span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">);</span>

<span class="c1">// 初始确认连接的点为0</span>
<span class="kt">int</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// 其它点到起始点的距离</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">start_index</span><span class="p">)</span>
<span class="w">        </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">start_index</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id6">
<h4>3.2 依据min_cost数据来查找最小边<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h4>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">min_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">;</span><span class="w"> </span><span class="c1">// 下一个最小边</span>
<span class="kt">int</span><span class="w"> </span><span class="n">min_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 下一个连接最小边的点</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 排除已连接 &amp;&amp; 最小距离</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">connected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">min_edge</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">min_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="n">min_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id7">
<h4>3.3 渐进式更新min_cost数组<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h4>
<p>正常思维，存点阵之间相互的最短连接距离一般得要O(n^2)的时间复杂度，就是一开始用到的方法，每个已连接节点算一遍到剩余节点的距离，每次大循环都需要重新算一遍，就比较费时</p>
<p>这里因为起始点已经算过，假设我们从第二个已连接点开始算，依次计算剩余点到新连接点的距离，如果有比上一轮距离起始点还短的距离，则抛弃旧路径，保留新路径。这样每次就只用计算新增节点的权值，而不用迭代计算全部节点的权值。</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// 更新最短距离数列</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 排除已连接 &amp;&amp; 比当前最小边还小</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">connected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">min_point</span><span class="p">])</span>
<span class="w">        </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">min_point</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id8">
<h3>4. 完整代码<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Prim</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">Prim</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;&amp;</span><span class="w"> </span><span class="n">pts</span><span class="p">)</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">min_cost</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">)</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">connected</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">points</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// 预计算所有坐标点的距离</span>
<span class="w">        </span><span class="n">CalcAllDistance</span><span class="p">(</span><span class="n">points</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 初始确认连接的点为0</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// 你要设为其它索引作为其实点也行，反正最后都要连上的</span>
<span class="w">        </span><span class="n">connected</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">start_index</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 其它点到起始点的距离</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">start_index</span><span class="p">)</span>
<span class="w">                </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">start_index</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// 查找确认最小路径</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">FindMinEdge</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">MinCost</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">total_cost</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// 计算曼哈顿距离</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">Distance</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">indexA</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">indexB</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">indexA</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">points</span><span class="p">[</span><span class="n">indexB</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">indexA</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">points</span><span class="p">[</span><span class="n">indexB</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 预计算所有坐标点的距离</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">CalcAllDistance</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Distance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 查找最小边</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">FindMinEdge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 下一个最小边</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">min_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// 下一个连接最小边的点</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">min_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 排除已连接 &amp;&amp; 最小距离</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">connected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">min_edge</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">min_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">                </span><span class="n">min_edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// 找到最小边后更新总费用和已连接数列</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">min_point</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">min_edge</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">path</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">min_point</span><span class="p">);</span>
<span class="w">            </span><span class="n">connected</span><span class="p">[</span><span class="n">min_point</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">            </span><span class="n">total_cost</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">min_edge</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// 更新最短距离数列</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 排除已连接 &amp;&amp; 比当前最小边还小</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">connected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">min_point</span><span class="p">])</span>
<span class="w">                </span><span class="n">min_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">min_point</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// 存了所有坐标点距离的邻接矩阵缓存</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">distance_cache</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// 最短距离</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">min_cost</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// 辅助数组，表示每个点是否已经被确认为已连接，避免重复搜索</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">connected</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// points是一个二维数组，每行存了一个点的XY坐标</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">points</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// 已经确定的连接点的索引数列</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// 最小总费用</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">total_cost</span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>
<span class="p">};</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Solution</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">minCostConnectPoints</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">points</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Prim</span><span class="w"> </span><span class="nf">p</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">points</span><span class="p">));</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">MinCost</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 20</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">},{</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">},{</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">},{</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">}};</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Solution</span><span class="o">::</span><span class="n">minCostConnectPoints</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 351638</span>
<span class="w">    </span><span class="n">pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="mi">-5698</span><span class="p">,</span><span class="mi">-8233</span><span class="p">},{</span><span class="mi">1026</span><span class="p">,</span><span class="mi">4797</span><span class="p">},{</span><span class="mi">8195</span><span class="p">,</span><span class="mi">8437</span><span class="p">},{</span><span class="mi">3498</span><span class="p">,</span><span class="mi">-9980</span><span class="p">},{</span><span class="mi">5222</span><span class="p">,</span><span class="mi">-4322</span><span class="p">},{</span><span class="mi">-5589</span><span class="p">,</span><span class="mi">-7532</span><span class="p">},{</span><span class="mi">2098</span><span class="p">,</span><span class="mi">-3463</span><span class="p">},{</span><span class="mi">-9603</span><span class="p">,</span><span class="mi">-3604</span><span class="p">},{</span><span class="mi">-6057</span><span class="p">,</span><span class="mi">8315</span><span class="p">},{</span><span class="mi">-1259</span><span class="p">,</span><span class="mi">2835</span><span class="p">},{</span><span class="mi">-728</span><span class="p">,</span><span class="mi">-4985</span><span class="p">},{</span><span class="mi">-7736</span><span class="p">,</span><span class="mi">-1357</span><span class="p">},{</span><span class="mi">-3403</span><span class="p">,</span><span class="mi">912</span><span class="p">},{</span><span class="mi">307</span><span class="p">,</span><span class="mi">3130</span><span class="p">},{</span><span class="mi">-7891</span><span class="p">,</span><span class="mi">-1896</span><span class="p">},{</span><span class="mi">5347</span><span class="p">,</span><span class="mi">4345</span><span class="p">},{</span><span class="mi">-4634</span><span class="p">,</span><span class="mi">718</span><span class="p">},{</span><span class="mi">205</span><span class="p">,</span><span class="mi">-9439</span><span class="p">},{</span><span class="mi">5061</span><span class="p">,</span><span class="mi">2060</span><span class="p">},{</span><span class="mi">-6672</span><span class="p">,</span><span class="mi">-9647</span><span class="p">},{</span><span class="mi">5682</span><span class="p">,</span><span class="mi">7606</span><span class="p">},{</span><span class="mi">-1954</span><span class="p">,</span><span class="mi">-5638</span><span class="p">},{</span><span class="mi">9478</span><span class="p">,</span><span class="mi">-2673</span><span class="p">},{</span><span class="mi">-1520</span><span class="p">,</span><span class="mi">-3300</span><span class="p">},{</span><span class="mi">4245</span><span class="p">,</span><span class="mi">7018</span><span class="p">},{</span><span class="mi">-9850</span><span class="p">,</span><span class="mi">-1419</span><span class="p">},{</span><span class="mi">9311</span><span class="p">,</span><span class="mi">-4321</span><span class="p">},{</span><span class="mi">-8522</span><span class="p">,</span><span class="mi">9196</span><span class="p">},{</span><span class="mi">8161</span><span class="p">,</span><span class="mi">4077</span><span class="p">},{</span><span class="mi">78</span><span class="p">,</span><span class="mi">6893</span><span class="p">},{</span><span class="mi">-250</span><span class="p">,</span><span class="mi">3376</span><span class="p">},{</span><span class="mi">-5764</span><span class="p">,</span><span class="mi">-6641</span><span class="p">},{</span><span class="mi">-9870</span><span class="p">,</span><span class="mi">-2137</span><span class="p">},{</span><span class="mi">6358</span><span class="p">,</span><span class="mi">477</span><span class="p">},{</span><span class="mi">2145</span><span class="p">,</span><span class="mi">-6866</span><span class="p">},{</span><span class="mi">2677</span><span class="p">,</span><span class="mi">1564</span><span class="p">},{</span><span class="mi">-394</span><span class="p">,</span><span class="mi">-8628</span><span class="p">},{</span><span class="mi">-9669</span><span class="p">,</span><span class="mi">2688</span><span class="p">},{</span><span class="mi">-6124</span><span class="p">,</span><span class="mi">8802</span><span class="p">},{</span><span class="mi">4731</span><span class="p">,</span><span class="mi">-6891</span><span class="p">},{</span><span class="mi">6841</span><span class="p">,</span><span class="mi">-4542</span><span class="p">},{</span><span class="mi">-849</span><span class="p">,</span><span class="mi">-5183</span><span class="p">},{</span><span class="mi">-5049</span><span class="p">,</span><span class="mi">6470</span><span class="p">},{</span><span class="mi">752</span><span class="p">,</span><span class="mi">9487</span><span class="p">},{</span><span class="mi">-2382</span><span class="p">,</span><span class="mi">-787</span><span class="p">},{</span><span class="mi">-2679</span><span class="p">,</span><span class="mi">7391</span><span class="p">},{</span><span class="mi">-4088</span><span class="p">,</span><span class="mi">4983</span><span class="p">},{</span><span class="mi">9609</span><span class="p">,</span><span class="mi">7633</span><span class="p">},{</span><span class="mi">5588</span><span class="p">,</span><span class="mi">-4217</span><span class="p">},{</span><span class="mi">2029</span><span class="p">,</span><span class="mi">9029</span><span class="p">},{</span><span class="mi">5166</span><span class="p">,</span><span class="mi">2772</span><span class="p">},{</span><span class="mi">-2614</span><span class="p">,</span><span class="mi">2036</span><span class="p">},{</span><span class="mi">9452</span><span class="p">,</span><span class="mi">5837</span><span class="p">},{</span><span class="mi">-1398</span><span class="p">,</span><span class="mi">-4690</span><span class="p">},{</span><span class="mi">5367</span><span class="p">,</span><span class="mi">-9452</span><span class="p">},{</span><span class="mi">2557</span><span class="p">,</span><span class="mi">4278</span><span class="p">},{</span><span class="mi">3018</span><span class="p">,</span><span class="mi">8427</span><span class="p">},{</span><span class="mi">-5050</span><span class="p">,</span><span class="mi">-3043</span><span class="p">},{</span><span class="mi">-3402</span><span class="p">,</span><span class="mi">9306</span><span class="p">},{</span><span class="mi">5905</span><span class="p">,</span><span class="mi">-886</span><span class="p">},{</span><span class="mi">-5711</span><span class="p">,</span><span class="mi">7472</span><span class="p">},{</span><span class="mi">-4855</span><span class="p">,</span><span class="mi">-7741</span><span class="p">},{</span><span class="mi">-3874</span><span class="p">,</span><span class="mi">-8015</span><span class="p">},{</span><span class="mi">6662</span><span class="p">,</span><span class="mi">7579</span><span class="p">},{</span><span class="mi">7111</span><span class="p">,</span><span class="mi">5400</span><span class="p">},{</span><span class="mi">-6518</span><span class="p">,</span><span class="mi">835</span><span class="p">},{</span><span class="mi">8744</span><span class="p">,</span><span class="mi">7618</span><span class="p">},{</span><span class="mi">-5018</span><span class="p">,</span><span class="mi">6824</span><span class="p">},{</span><span class="mi">2967</span><span class="p">,</span><span class="mi">1579</span><span class="p">},{</span><span class="mi">-9125</span><span class="p">,</span><span class="mi">1051</span><span class="p">},{</span><span class="mi">4453</span><span class="p">,</span><span class="mi">3851</span><span class="p">},{</span><span class="mi">1745</span><span class="p">,</span><span class="mi">-1764</span><span class="p">},{</span><span class="mi">4243</span><span class="p">,</span><span class="mi">2062</span><span class="p">},{</span><span class="mi">9773</span><span class="p">,</span><span class="mi">7988</span><span class="p">},{</span><span class="mi">-908</span><span class="p">,</span><span class="mi">9980</span><span class="p">},{</span><span class="mi">4519</span><span class="p">,</span><span class="mi">7744</span><span class="p">},{</span><span class="mi">-5959</span><span class="p">,</span><span class="mi">8796</span><span class="p">},{</span><span class="mi">-1050</span><span class="p">,</span><span class="mi">-8178</span><span class="p">},{</span><span class="mi">496</span><span class="p">,</span><span class="mi">7536</span><span class="p">},{</span><span class="mi">161</span><span class="p">,</span><span class="mi">4729</span><span class="p">},{</span><span class="mi">-2559</span><span class="p">,</span><span class="mi">-2468</span><span class="p">},{</span><span class="mi">-8038</span><span class="p">,</span><span class="mi">-6269</span><span class="p">},{</span><span class="mi">-2701</span><span class="p">,</span><span class="mi">-3586</span><span class="p">},{</span><span class="mi">3054</span><span class="p">,</span><span class="mi">-4072</span><span class="p">},{</span><span class="mi">-5171</span><span class="p">,</span><span class="mi">2062</span><span class="p">},{</span><span class="mi">-6688</span><span class="p">,</span><span class="mi">3479</span><span class="p">},{</span><span class="mi">4423</span><span class="p">,</span><span class="mi">-3834</span><span class="p">},{</span><span class="mi">-8404</span><span class="p">,</span><span class="mi">-723</span><span class="p">},{</span><span class="mi">-1316</span><span class="p">,</span><span class="mi">8726</span><span class="p">},{</span><span class="mi">-2303</span><span class="p">,</span><span class="mi">-1381</span><span class="p">},{</span><span class="mi">4793</span><span class="p">,</span><span class="mi">5648</span><span class="p">},{</span><span class="mi">-4862</span><span class="p">,</span><span class="mi">5489</span><span class="p">},{</span><span class="mi">-772</span><span class="p">,</span><span class="mi">-8258</span><span class="p">},{</span><span class="mi">851</span><span class="p">,</span><span class="mi">-9830</span><span class="p">},{</span><span class="mi">-5218</span><span class="p">,</span><span class="mi">-5705</span><span class="p">},{</span><span class="mi">-5323</span><span class="p">,</span><span class="mi">7785</span><span class="p">},{</span><span class="mi">-7762</span><span class="p">,</span><span class="mi">-8046</span><span class="p">},{</span><span class="mi">7317</span><span class="p">,</span><span class="mi">1475</span><span class="p">},{</span><span class="mi">1820</span><span class="p">,</span><span class="mi">-4586</span><span class="p">},{</span><span class="mi">2150</span><span class="p">,</span><span class="mi">140</span><span class="p">},{</span><span class="mi">-4643</span><span class="p">,</span><span class="mi">4190</span><span class="p">},{</span><span class="mi">-2389</span><span class="p">,</span><span class="mi">-5398</span><span class="p">},{</span><span class="mi">-786</span><span class="p">,</span><span class="mi">-9999</span><span class="p">},{</span><span class="mi">5768</span><span class="p">,</span><span class="mi">-208</span><span class="p">},{</span><span class="mi">5908</span><span class="p">,</span><span class="mi">-3623</span><span class="p">},{</span><span class="mi">-869</span><span class="p">,</span><span class="mi">5566</span><span class="p">},{</span><span class="mi">-3238</span><span class="p">,</span><span class="mi">6606</span><span class="p">},{</span><span class="mi">-1247</span><span class="p">,</span><span class="mi">6673</span><span class="p">},{</span><span class="mi">113</span><span class="p">,</span><span class="mi">-9718</span><span class="p">},{</span><span class="mi">-1819</span><span class="p">,</span><span class="mi">-7680</span><span class="p">},{</span><span class="mi">9333</span><span class="p">,</span><span class="mi">1395</span><span class="p">},{</span><span class="mi">-9716</span><span class="p">,</span><span class="mi">-9202</span><span class="p">},{</span><span class="mi">-5926</span><span class="p">,</span><span class="mi">3456</span><span class="p">},{</span><span class="mi">-1893</span><span class="p">,</span><span class="mi">-2083</span><span class="p">},{</span><span class="mi">-6634</span><span class="p">,</span><span class="mi">-1278</span><span class="p">},{</span><span class="mi">-5122</span><span class="p">,</span><span class="mi">-8749</span><span class="p">},{</span><span class="mi">8528</span><span class="p">,</span><span class="mi">1204</span><span class="p">},{</span><span class="mi">-1210</span><span class="p">,</span><span class="mi">-2230</span><span class="p">},{</span><span class="mi">-2195</span><span class="p">,</span><span class="mi">4983</span><span class="p">},{</span><span class="mi">9539</span><span class="p">,</span><span class="mi">-4935</span><span class="p">},{</span><span class="mi">-2339</span><span class="p">,</span><span class="mi">5310</span><span class="p">},{</span><span class="mi">-153</span><span class="p">,</span><span class="mi">-7579</span><span class="p">},{</span><span class="mi">4629</span><span class="p">,</span><span class="mi">-7497</span><span class="p">},{</span><span class="mi">294</span><span class="p">,</span><span class="mi">-6041</span><span class="p">},{</span><span class="mi">7572</span><span class="p">,</span><span class="mi">-8638</span><span class="p">},{</span><span class="mi">3024</span><span class="p">,</span><span class="mi">-4783</span><span class="p">},{</span><span class="mi">-2416</span><span class="p">,</span><span class="mi">2260</span><span class="p">},{</span><span class="mi">-3728</span><span class="p">,</span><span class="mi">2560</span><span class="p">},{</span><span class="mi">-6499</span><span class="p">,</span><span class="mi">3001</span><span class="p">},{</span><span class="mi">7706</span><span class="p">,</span><span class="mi">6003</span><span class="p">},{</span><span class="mi">8700</span><span class="p">,</span><span class="mi">5144</span><span class="p">},{</span><span class="mi">-54</span><span class="p">,</span><span class="mi">6420</span><span class="p">},{</span><span class="mi">-5355</span><span class="p">,</span><span class="mi">7235</span><span class="p">},{</span><span class="mi">-7327</span><span class="p">,</span><span class="mi">7085</span><span class="p">},{</span><span class="mi">1379</span><span class="p">,</span><span class="mi">7006</span><span class="p">},{</span><span class="mi">-6631</span><span class="p">,</span><span class="mi">4364</span><span class="p">},{</span><span class="mi">8590</span><span class="p">,</span><span class="mi">-2063</span><span class="p">},{</span><span class="mi">124</span><span class="p">,</span><span class="mi">-991</span><span class="p">},{</span><span class="mi">4997</span><span class="p">,</span><span class="mi">-732</span><span class="p">},{</span><span class="mi">8748</span><span class="p">,</span><span class="mi">-2321</span><span class="p">},{</span><span class="mi">8827</span><span class="p">,</span><span class="mi">-5733</span><span class="p">},{</span><span class="mi">-9958</span><span class="p">,</span><span class="mi">7106</span><span class="p">},{</span><span class="mi">6999</span><span class="p">,</span><span class="mi">9696</span><span class="p">},{</span><span class="mi">-6653</span><span class="p">,</span><span class="mi">4769</span><span class="p">},{</span><span class="mi">-6316</span><span class="p">,</span><span class="mi">8075</span><span class="p">},{</span><span class="mi">-5669</span><span class="p">,</span><span class="mi">-1720</span><span class="p">},{</span><span class="mi">5473</span><span class="p">,</span><span class="mi">-2215</span><span class="p">},{</span><span class="mi">4798</span><span class="p">,</span><span class="mi">8281</span><span class="p">},{</span><span class="mi">4174</span><span class="p">,</span><span class="mi">-717</span><span class="p">},{</span><span class="mi">9465</span><span class="p">,</span><span class="mi">-6092</span><span class="p">},{</span><span class="mi">7763</span><span class="p">,</span><span class="mi">9754</span><span class="p">},{</span><span class="mi">-2942</span><span class="p">,</span><span class="mi">-4927</span><span class="p">},{</span><span class="mi">-9770</span><span class="p">,</span><span class="mi">-2867</span><span class="p">},{</span><span class="mi">-8570</span><span class="p">,</span><span class="mi">4194</span><span class="p">},{</span><span class="mi">-801</span><span class="p">,</span><span class="mi">6443</span><span class="p">},{</span><span class="mi">-7374</span><span class="p">,</span><span class="mi">3245</span><span class="p">},{</span><span class="mi">-5159</span><span class="p">,</span><span class="mi">-1232</span><span class="p">},{</span><span class="mi">189</span><span class="p">,</span><span class="mi">9554</span><span class="p">},{</span><span class="mi">-9721</span><span class="p">,</span><span class="mi">-27</span><span class="p">},{</span><span class="mi">6907</span><span class="p">,</span><span class="mi">-6585</span><span class="p">},{</span><span class="mi">-859</span><span class="p">,</span><span class="mi">-3675</span><span class="p">},{</span><span class="mi">-6841</span><span class="p">,</span><span class="mi">8855</span><span class="p">},{</span><span class="mi">8934</span><span class="p">,</span><span class="mi">-9852</span><span class="p">},{</span><span class="mi">1675</span><span class="p">,</span><span class="mi">-7822</span><span class="p">},{</span><span class="mi">-6489</span><span class="p">,</span><span class="mi">-8706</span><span class="p">},{</span><span class="mi">-7575</span><span class="p">,</span><span class="mi">6401</span><span class="p">},{</span><span class="mi">-546</span><span class="p">,</span><span class="mi">178</span><span class="p">},{</span><span class="mi">5666</span><span class="p">,</span><span class="mi">-6399</span><span class="p">},{</span><span class="mi">6841</span><span class="p">,</span><span class="mi">7530</span><span class="p">},{</span><span class="mi">4665</span><span class="p">,</span><span class="mi">-7514</span><span class="p">},{</span><span class="mi">-1565</span><span class="p">,</span><span class="mi">-1960</span><span class="p">},{</span><span class="mi">-3214</span><span class="p">,</span><span class="mi">3199</span><span class="p">},{</span><span class="mi">-8671</span><span class="p">,</span><span class="mi">8382</span><span class="p">},{</span><span class="mi">-1780</span><span class="p">,</span><span class="mi">-2431</span><span class="p">},{</span><span class="mi">5434</span><span class="p">,</span><span class="mi">-8329</span><span class="p">},{</span><span class="mi">-6027</span><span class="p">,</span><span class="mi">-2661</span><span class="p">},{</span><span class="mi">8458</span><span class="p">,</span><span class="mi">-9085</span><span class="p">},{</span><span class="mi">881</span><span class="p">,</span><span class="mi">-5237</span><span class="p">},{</span><span class="mi">-2343</span><span class="p">,</span><span class="mi">6666</span><span class="p">},{</span><span class="mi">5584</span><span class="p">,</span><span class="mi">-9490</span><span class="p">},{</span><span class="mi">4027</span><span class="p">,</span><span class="mi">5207</span><span class="p">},{</span><span class="mi">-4352</span><span class="p">,</span><span class="mi">8676</span><span class="p">},{</span><span class="mi">-4678</span><span class="p">,</span><span class="mi">110</span><span class="p">},{</span><span class="mi">-6308</span><span class="p">,</span><span class="mi">3922</span><span class="p">},{</span><span class="mi">6848</span><span class="p">,</span><span class="mi">9570</span><span class="p">},{</span><span class="mi">-2108</span><span class="p">,</span><span class="mi">-2837</span><span class="p">},{</span><span class="mi">-6291</span><span class="p">,</span><span class="mi">-4718</span><span class="p">},{</span><span class="mi">1659</span><span class="p">,</span><span class="mi">4767</span><span class="p">},{</span><span class="mi">1723</span><span class="p">,</span><span class="mi">-4909</span><span class="p">},{</span><span class="mi">-5944</span><span class="p">,</span><span class="mi">-6446</span><span class="p">},{</span><span class="mi">6548</span><span class="p">,</span><span class="mi">9498</span><span class="p">},{</span><span class="mi">-8475</span><span class="p">,</span><span class="mi">-1982</span><span class="p">},{</span><span class="mi">4598</span><span class="p">,</span><span class="mi">-3275</span><span class="p">},{</span><span class="mi">8346</span><span class="p">,</span><span class="mi">5422</span><span class="p">},{</span><span class="mi">5298</span><span class="p">,</span><span class="mi">-6086</span><span class="p">},{</span><span class="mi">2005</span><span class="p">,</span><span class="mi">-7830</span><span class="p">},{</span><span class="mi">-4528</span><span class="p">,</span><span class="mi">3574</span><span class="p">},{</span><span class="mi">5557</span><span class="p">,</span><span class="mi">-9429</span><span class="p">},{</span><span class="mi">-8988</span><span class="p">,</span><span class="mi">-4465</span><span class="p">},{</span><span class="mi">-5814</span><span class="p">,</span><span class="mi">-9101</span><span class="p">},{</span><span class="mi">2809</span><span class="p">,</span><span class="mi">5688</span><span class="p">},{</span><span class="mi">1525</span><span class="p">,</span><span class="mi">5986</span><span class="p">},{</span><span class="mi">-2094</span><span class="p">,</span><span class="mi">-4340</span><span class="p">},{</span><span class="mi">2089</span><span class="p">,</span><span class="mi">7047</span><span class="p">},{</span><span class="mi">-6276</span><span class="p">,</span><span class="mi">2758</span><span class="p">},{</span><span class="mi">423</span><span class="p">,</span><span class="mi">2767</span><span class="p">},{</span><span class="mi">4590</span><span class="p">,</span><span class="mi">-5166</span><span class="p">},{</span><span class="mi">5637</span><span class="p">,</span><span class="mi">5134</span><span class="p">},{</span><span class="mi">8738</span><span class="p">,</span><span class="mi">-3710</span><span class="p">},{</span><span class="mi">-418</span><span class="p">,</span><span class="mi">6321</span><span class="p">},{</span><span class="mi">-3450</span><span class="p">,</span><span class="mi">-9162</span><span class="p">},{</span><span class="mi">-6105</span><span class="p">,</span><span class="mi">-8925</span><span class="p">},{</span><span class="mi">285</span><span class="p">,</span><span class="mi">-6936</span><span class="p">},{</span><span class="mi">-6194</span><span class="p">,</span><span class="mi">6073</span><span class="p">},{</span><span class="mi">4258</span><span class="p">,</span><span class="mi">1301</span><span class="p">},{</span><span class="mi">-5567</span><span class="p">,</span><span class="mi">-1161</span><span class="p">},{</span><span class="mi">4306</span><span class="p">,</span><span class="mi">-2707</span><span class="p">},{</span><span class="mi">1113</span><span class="p">,</span><span class="mi">5653</span><span class="p">},{</span><span class="mi">-4610</span><span class="p">,</span><span class="mi">-2182</span><span class="p">},{</span><span class="mi">1987</span><span class="p">,</span><span class="mi">-24</span><span class="p">},{</span><span class="mi">1374</span><span class="p">,</span><span class="mi">4615</span><span class="p">},{</span><span class="mi">1320</span><span class="p">,</span><span class="mi">5650</span><span class="p">},{</span><span class="mi">-9531</span><span class="p">,</span><span class="mi">5679</span><span class="p">},{</span><span class="mi">1195</span><span class="p">,</span><span class="mi">1394</span><span class="p">},{</span><span class="mi">-8347</span><span class="p">,</span><span class="mi">-8318</span><span class="p">},{</span><span class="mi">114</span><span class="p">,</span><span class="mi">438</span><span class="p">},{</span><span class="mi">-6603</span><span class="p">,</span><span class="mi">-3452</span><span class="p">},{</span><span class="mi">-6512</span><span class="p">,</span><span class="mi">-9403</span><span class="p">},{</span><span class="mi">2763</span><span class="p">,</span><span class="mi">3338</span><span class="p">},{</span><span class="mi">-4136</span><span class="p">,</span><span class="mi">3306</span><span class="p">},{</span><span class="mi">1350</span><span class="p">,</span><span class="mi">-958</span><span class="p">},{</span><span class="mi">6573</span><span class="p">,</span><span class="mi">-4548</span><span class="p">},{</span><span class="mi">-5830</span><span class="p">,</span><span class="mi">-7189</span><span class="p">},{</span><span class="mi">6149</span><span class="p">,</span><span class="mi">-2963</span><span class="p">},{</span><span class="mi">-6957</span><span class="p">,</span><span class="mi">1571</span><span class="p">},{</span><span class="mi">-2225</span><span class="p">,</span><span class="mi">-7921</span><span class="p">},{</span><span class="mi">-6151</span><span class="p">,</span><span class="mi">6881</span><span class="p">},{</span><span class="mi">-2954</span><span class="p">,</span><span class="mi">3537</span><span class="p">},{</span><span class="mi">628</span><span class="p">,</span><span class="mi">3738</span><span class="p">},{</span><span class="mi">8103</span><span class="p">,</span><span class="mi">6531</span><span class="p">},{</span><span class="mi">-1959</span><span class="p">,</span><span class="mi">821</span><span class="p">},{</span><span class="mi">-8322</span><span class="p">,</span><span class="mi">1729</span><span class="p">},{</span><span class="mi">3933</span><span class="p">,</span><span class="mi">-6371</span><span class="p">},{</span><span class="mi">-2922</span><span class="p">,</span><span class="mi">-2509</span><span class="p">},{</span><span class="mi">-8441</span><span class="p">,</span><span class="mi">-3109</span><span class="p">},{</span><span class="mi">2677</span><span class="p">,</span><span class="mi">3230</span><span class="p">},{</span><span class="mi">8645</span><span class="p">,</span><span class="mi">3667</span><span class="p">},{</span><span class="mi">-6378</span><span class="p">,</span><span class="mi">-3285</span><span class="p">},{</span><span class="mi">8870</span><span class="p">,</span><span class="mi">-4684</span><span class="p">},{</span><span class="mi">-8930</span><span class="p">,</span><span class="mi">2032</span><span class="p">},{</span><span class="mi">-3529</span><span class="p">,</span><span class="mi">1453</span><span class="p">},{</span><span class="mi">637</span><span class="p">,</span><span class="mi">-5024</span><span class="p">},{</span><span class="mi">-8292</span><span class="p">,</span><span class="mi">2526</span><span class="p">},{</span><span class="mi">5663</span><span class="p">,</span><span class="mi">-5360</span><span class="p">},{</span><span class="mi">-8694</span><span class="p">,</span><span class="mi">-2729</span><span class="p">},{</span><span class="mi">-8333</span><span class="p">,</span><span class="mi">-1188</span><span class="p">},{</span><span class="mi">-5749</span><span class="p">,</span><span class="mi">2871</span><span class="p">},{</span><span class="mi">2538</span><span class="p">,</span><span class="mi">-9028</span><span class="p">},{</span><span class="mi">-5990</span><span class="p">,</span><span class="mi">-118</span><span class="p">},{</span><span class="mi">7641</span><span class="p">,</span><span class="mi">-1651</span><span class="p">},{</span><span class="mi">-1312</span><span class="p">,</span><span class="mi">5346</span><span class="p">},{</span><span class="mi">8578</span><span class="p">,</span><span class="mi">-4859</span><span class="p">},{</span><span class="mi">-9958</span><span class="p">,</span><span class="mi">9666</span><span class="p">},{</span><span class="mi">4485</span><span class="p">,</span><span class="mi">-4112</span><span class="p">},{</span><span class="mi">4067</span><span class="p">,</span><span class="mi">-3731</span><span class="p">},{</span><span class="mi">-4199</span><span class="p">,</span><span class="mi">-6144</span><span class="p">},{</span><span class="mi">-9647</span><span class="p">,</span><span class="mi">-6230</span><span class="p">},{</span><span class="mi">-5366</span><span class="p">,</span><span class="mi">-6184</span><span class="p">},{</span><span class="mi">-803</span><span class="p">,</span><span class="mi">-7515</span><span class="p">},{</span><span class="mi">2075</span><span class="p">,</span><span class="mi">3361</span><span class="p">},{</span><span class="mi">3442</span><span class="p">,</span><span class="mi">828</span><span class="p">},{</span><span class="mi">3661</span><span class="p">,</span><span class="mi">1253</span><span class="p">},{</span><span class="mi">-6315</span><span class="p">,</span><span class="mi">-4061</span><span class="p">},{</span><span class="mi">214</span><span class="p">,</span><span class="mi">-6752</span><span class="p">},{</span><span class="mi">4305</span><span class="p">,</span><span class="mi">3912</span><span class="p">},{</span><span class="mi">-8961</span><span class="p">,</span><span class="mi">9710</span><span class="p">},{</span><span class="mi">4404</span><span class="p">,</span><span class="mi">8651</span><span class="p">},{</span><span class="mi">3338</span><span class="p">,</span><span class="mi">-7</span><span class="p">},{</span><span class="mi">-2860</span><span class="p">,</span><span class="mi">6387</span><span class="p">},{</span><span class="mi">5744</span><span class="p">,</span><span class="mi">2278</span><span class="p">},{</span><span class="mi">4214</span><span class="p">,</span><span class="mi">-7730</span><span class="p">},{</span><span class="mi">-1884</span><span class="p">,</span><span class="mi">-7994</span><span class="p">},{</span><span class="mi">5151</span><span class="p">,</span><span class="mi">8701</span><span class="p">},{</span><span class="mi">-3897</span><span class="p">,</span><span class="mi">8828</span><span class="p">},{</span><span class="mi">-8642</span><span class="p">,</span><span class="mi">5586</span><span class="p">},{</span><span class="mi">3482</span><span class="p">,</span><span class="mi">7427</span><span class="p">},{</span><span class="mi">-9509</span><span class="p">,</span><span class="mi">1333</span><span class="p">},{</span><span class="mi">-2108</span><span class="p">,</span><span class="mi">5560</span><span class="p">},{</span><span class="mi">-3340</span><span class="p">,</span><span class="mi">7145</span><span class="p">},{</span><span class="mi">8741</span><span class="p">,</span><span class="mi">2428</span><span class="p">},{</span><span class="mi">-5170</span><span class="p">,</span><span class="mi">1157</span><span class="p">},{</span><span class="mi">690</span><span class="p">,</span><span class="mi">-9469</span><span class="p">},{</span><span class="mi">-312</span><span class="p">,</span><span class="mi">1334</span><span class="p">},{</span><span class="mi">-8163</span><span class="p">,</span><span class="mi">-2838</span><span class="p">},{</span><span class="mi">-7934</span><span class="p">,</span><span class="mi">-7494</span><span class="p">},{</span><span class="mi">7417</span><span class="p">,</span><span class="mi">-9102</span><span class="p">},{</span><span class="mi">-5876</span><span class="p">,</span><span class="mi">-9336</span><span class="p">},{</span><span class="mi">-5080</span><span class="p">,</span><span class="mi">-7916</span><span class="p">},{</span><span class="mi">-5536</span><span class="p">,</span><span class="mi">9034</span><span class="p">},{</span><span class="mi">6545</span><span class="p">,</span><span class="mi">-1656</span><span class="p">},{</span><span class="mi">4362</span><span class="p">,</span><span class="mi">498</span><span class="p">},{</span><span class="mi">-917</span><span class="p">,</span><span class="mi">933</span><span class="p">},{</span><span class="mi">-7214</span><span class="p">,</span><span class="mi">5875</span><span class="p">},{</span><span class="mi">1411</span><span class="p">,</span><span class="mi">1117</span><span class="p">},{</span><span class="mi">-3357</span><span class="p">,</span><span class="mi">5667</span><span class="p">},{</span><span class="mi">-3406</span><span class="p">,</span><span class="mi">3817</span><span class="p">},{</span><span class="mi">-3980</span><span class="p">,</span><span class="mi">-9798</span><span class="p">},{</span><span class="mi">-4892</span><span class="p">,</span><span class="mi">797</span><span class="p">},{</span><span class="mi">-8927</span><span class="p">,</span><span class="mi">8941</span><span class="p">},{</span><span class="mi">-2861</span><span class="p">,</span><span class="mi">-5003</span><span class="p">},{</span><span class="mi">-3183</span><span class="p">,</span><span class="mi">2331</span><span class="p">},{</span><span class="mi">1632</span><span class="p">,</span><span class="mi">-9390</span><span class="p">},{</span><span class="mi">6131</span><span class="p">,</span><span class="mi">1978</span><span class="p">},{</span><span class="mi">8993</span><span class="p">,</span><span class="mi">9089</span><span class="p">},{</span><span class="mi">-2151</span><span class="p">,</span><span class="mi">-9220</span><span class="p">},{</span><span class="mi">-8772</span><span class="p">,</span><span class="mi">-6323</span><span class="p">},{</span><span class="mi">-2458</span><span class="p">,</span><span class="mi">6153</span><span class="p">},{</span><span class="mi">8078</span><span class="p">,</span><span class="mi">-4117</span><span class="p">},{</span><span class="mi">-3571</span><span class="p">,</span><span class="mi">3464</span><span class="p">},{</span><span class="mi">-877</span><span class="p">,</span><span class="mi">-7206</span><span class="p">},{</span><span class="mi">6074</span><span class="p">,</span><span class="mi">-5182</span><span class="p">},{</span><span class="mi">-9085</span><span class="p">,</span><span class="mi">-4133</span><span class="p">},{</span><span class="mi">-6966</span><span class="p">,</span><span class="mi">-4049</span><span class="p">},{</span><span class="mi">9538</span><span class="p">,</span><span class="mi">-8572</span><span class="p">},{</span><span class="mi">7752</span><span class="p">,</span><span class="mi">-196</span><span class="p">},{</span><span class="mi">6887</span><span class="p">,</span><span class="mi">8882</span><span class="p">},{</span><span class="mi">-7154</span><span class="p">,</span><span class="mi">7452</span><span class="p">},{</span><span class="mi">-1800</span><span class="p">,</span><span class="mi">7320</span><span class="p">},{</span><span class="mi">-9736</span><span class="p">,</span><span class="mi">7263</span><span class="p">},{</span><span class="mi">1265</span><span class="p">,</span><span class="mi">7537</span><span class="p">},{</span><span class="mi">4684</span><span class="p">,</span><span class="mi">-8260</span><span class="p">},{</span><span class="mi">2572</span><span class="p">,</span><span class="mi">4413</span><span class="p">},{</span><span class="mi">-2022</span><span class="p">,</span><span class="mi">1650</span><span class="p">},{</span><span class="mi">2676</span><span class="p">,</span><span class="mi">-3224</span><span class="p">},{</span><span class="mi">5784</span><span class="p">,</span><span class="mi">-2351</span><span class="p">},{</span><span class="mi">-52</span><span class="p">,</span><span class="mi">1375</span><span class="p">},{</span><span class="mi">8735</span><span class="p">,</span><span class="mi">-7509</span><span class="p">},{</span><span class="mi">3338</span><span class="p">,</span><span class="mi">9006</span><span class="p">},{</span><span class="mi">7267</span><span class="p">,</span><span class="mi">3251</span><span class="p">},{</span><span class="mi">-1434</span><span class="p">,</span><span class="mi">-7395</span><span class="p">},{</span><span class="mi">6737</span><span class="p">,</span><span class="mi">-4749</span><span class="p">},{</span><span class="mi">68</span><span class="p">,</span><span class="mi">6977</span><span class="p">},{</span><span class="mi">-9757</span><span class="p">,</span><span class="mi">-9738</span><span class="p">},{</span><span class="mi">6935</span><span class="p">,</span><span class="mi">-9525</span><span class="p">},{</span><span class="mi">3486</span><span class="p">,</span><span class="mi">5691</span><span class="p">},{</span><span class="mi">4894</span><span class="p">,</span><span class="mi">-6794</span><span class="p">},{</span><span class="mi">5658</span><span class="p">,</span><span class="mi">-2055</span><span class="p">},{</span><span class="mi">2907</span><span class="p">,</span><span class="mi">-9576</span><span class="p">},{</span><span class="mi">-6947</span><span class="p">,</span><span class="mi">-4678</span><span class="p">},{</span><span class="mi">-9639</span><span class="p">,</span><span class="mi">7740</span><span class="p">},{</span><span class="mi">-6644</span><span class="p">,</span><span class="mi">-7749</span><span class="p">},{</span><span class="mi">-1758</span><span class="p">,</span><span class="mi">4464</span><span class="p">},{</span><span class="mi">-1164</span><span class="p">,</span><span class="mi">-7809</span><span class="p">},{</span><span class="mi">1320</span><span class="p">,</span><span class="mi">8410</span><span class="p">},{</span><span class="mi">-4209</span><span class="p">,</span><span class="mi">5625</span><span class="p">},{</span><span class="mi">-5332</span><span class="p">,</span><span class="mi">6191</span><span class="p">},{</span><span class="mi">3355</span><span class="p">,</span><span class="mi">-155</span><span class="p">},{</span><span class="mi">6578</span><span class="p">,</span><span class="mi">-1843</span><span class="p">},{</span><span class="mi">-8754</span><span class="p">,</span><span class="mi">-8416</span><span class="p">},{</span><span class="mi">-2439</span><span class="p">,</span><span class="mi">-3218</span><span class="p">},{</span><span class="mi">2036</span><span class="p">,</span><span class="mi">-4770</span><span class="p">},{</span><span class="mi">-484</span><span class="p">,</span><span class="mi">-9929</span><span class="p">},{</span><span class="mi">653</span><span class="p">,</span><span class="mi">5591</span><span class="p">},{</span><span class="mi">-7623</span><span class="p">,</span><span class="mi">9241</span><span class="p">},{</span><span class="mi">-6899</span><span class="p">,</span><span class="mi">6623</span><span class="p">},{</span><span class="mi">-7281</span><span class="p">,</span><span class="mi">-4130</span><span class="p">},{</span><span class="mi">3617</span><span class="p">,</span><span class="mi">1483</span><span class="p">},{</span><span class="mi">7161</span><span class="p">,</span><span class="mi">-4357</span><span class="p">},{</span><span class="mi">8987</span><span class="p">,</span><span class="mi">-1159</span><span class="p">},{</span><span class="mi">1849</span><span class="p">,</span><span class="mi">1262</span><span class="p">},{</span><span class="mi">-9027</span><span class="p">,</span><span class="mi">8958</span><span class="p">},{</span><span class="mi">992</span><span class="p">,</span><span class="mi">-420</span><span class="p">},{</span><span class="mi">1220</span><span class="p">,</span><span class="mi">-6801</span><span class="p">},{</span><span class="mi">-9770</span><span class="p">,</span><span class="mi">-3730</span><span class="p">},{</span><span class="mi">5156</span><span class="p">,</span><span class="mi">4240</span><span class="p">},{</span><span class="mi">-8355</span><span class="p">,</span><span class="mi">-1884</span><span class="p">},{</span><span class="mi">-5820</span><span class="p">,</span><span class="mi">-358</span><span class="p">},{</span><span class="mi">6255</span><span class="p">,</span><span class="mi">8001</span><span class="p">},{</span><span class="mi">-7344</span><span class="p">,</span><span class="mi">-4709</span><span class="p">},{</span><span class="mi">-8505</span><span class="p">,</span><span class="mi">8209</span><span class="p">},{</span><span class="mi">-9564</span><span class="p">,</span><span class="mi">-9172</span><span class="p">},{</span><span class="mi">1032</span><span class="p">,</span><span class="mi">-604</span><span class="p">},{</span><span class="mi">-1083</span><span class="p">,</span><span class="mi">-2613</span><span class="p">},{</span><span class="mi">-2190</span><span class="p">,</span><span class="mi">-6519</span><span class="p">},{</span><span class="mi">1882</span><span class="p">,</span><span class="mi">-8574</span><span class="p">},{</span><span class="mi">-5445</span><span class="p">,</span><span class="mi">-2921</span><span class="p">},{</span><span class="mi">7177</span><span class="p">,</span><span class="mi">358</span><span class="p">},{</span><span class="mi">2256</span><span class="p">,</span><span class="mi">-8305</span><span class="p">},{</span><span class="mi">790</span><span class="p">,</span><span class="mi">8004</span><span class="p">},{</span><span class="mi">1089</span><span class="p">,</span><span class="mi">-1798</span><span class="p">},{</span><span class="mi">8344</span><span class="p">,</span><span class="mi">-921</span><span class="p">},{</span><span class="mi">-8075</span><span class="p">,</span><span class="mi">-59</span><span class="p">},{</span><span class="mi">-4279</span><span class="p">,</span><span class="mi">2544</span><span class="p">},{</span><span class="mi">-3052</span><span class="p">,</span><span class="mi">-9733</span><span class="p">},{</span><span class="mi">-985</span><span class="p">,</span><span class="mi">3404</span><span class="p">},{</span><span class="mi">-3351</span><span class="p">,</span><span class="mi">-6341</span><span class="p">},{</span><span class="mi">-6097</span><span class="p">,</span><span class="mi">-7971</span><span class="p">},{</span><span class="mi">-3188</span><span class="p">,</span><span class="mi">-4125</span><span class="p">},{</span><span class="mi">2824</span><span class="p">,</span><span class="mi">5943</span><span class="p">},{</span><span class="mi">2294</span><span class="p">,</span><span class="mi">-6651</span><span class="p">},{</span><span class="mi">-920</span><span class="p">,</span><span class="mi">-6433</span><span class="p">},{</span><span class="mi">-6783</span><span class="p">,</span><span class="mi">4957</span><span class="p">},{</span><span class="mi">-9948</span><span class="p">,</span><span class="mi">7901</span><span class="p">},{</span><span class="mi">-7464</span><span class="p">,</span><span class="mi">3816</span><span class="p">},{</span><span class="mi">-6063</span><span class="p">,</span><span class="mi">-1903</span><span class="p">},{</span><span class="mi">791</span><span class="p">,</span><span class="mi">-8022</span><span class="p">},{</span><span class="mi">-2200</span><span class="p">,</span><span class="mi">-7450</span><span class="p">},{</span><span class="mi">2480</span><span class="p">,</span><span class="mi">1872</span><span class="p">},{</span><span class="mi">-6795</span><span class="p">,</span><span class="mi">5060</span><span class="p">},{</span><span class="mi">9765</span><span class="p">,</span><span class="mi">413</span><span class="p">},{</span><span class="mi">9183</span><span class="p">,</span><span class="mi">9179</span><span class="p">},{</span><span class="mi">4942</span><span class="p">,</span><span class="mi">8703</span><span class="p">},{</span><span class="mi">-8213</span><span class="p">,</span><span class="mi">-654</span><span class="p">},{</span><span class="mi">4930</span><span class="p">,</span><span class="mi">2730</span><span class="p">},{</span><span class="mi">6358</span><span class="p">,</span><span class="mi">6589</span><span class="p">},{</span><span class="mi">8222</span><span class="p">,</span><span class="mi">-9670</span><span class="p">},{</span><span class="mi">9857</span><span class="p">,</span><span class="mi">1241</span><span class="p">},{</span><span class="mi">4159</span><span class="p">,</span><span class="mi">-269</span><span class="p">},{</span><span class="mi">7318</span><span class="p">,</span><span class="mi">2587</span><span class="p">},{</span><span class="mi">-9114</span><span class="p">,</span><span class="mi">2789</span><span class="p">},{</span><span class="mi">-5124</span><span class="p">,</span><span class="mi">-9881</span><span class="p">},{</span><span class="mi">-5525</span><span class="p">,</span><span class="mi">7263</span><span class="p">},{</span><span class="mi">-7584</span><span class="p">,</span><span class="mi">-1725</span><span class="p">},{</span><span class="mi">9413</span><span class="p">,</span><span class="mi">-3888</span><span class="p">},{</span><span class="mi">-9749</span><span class="p">,</span><span class="mi">2216</span><span class="p">},{</span><span class="mi">-8622</span><span class="p">,</span><span class="mi">-419</span><span class="p">},{</span><span class="mi">3274</span><span class="p">,</span><span class="mi">-8722</span><span class="p">},{</span><span class="mi">6234</span><span class="p">,</span><span class="mi">-6800</span><span class="p">},{</span><span class="mi">-9116</span><span class="p">,</span><span class="mi">7304</span><span class="p">},{</span><span class="mi">-8765</span><span class="p">,</span><span class="mi">-471</span><span class="p">},{</span><span class="mi">-7918</span><span class="p">,</span><span class="mi">-9246</span><span class="p">},{</span><span class="mi">5972</span><span class="p">,</span><span class="mi">-470</span><span class="p">},{</span><span class="mi">3310</span><span class="p">,</span><span class="mi">7609</span><span class="p">},{</span><span class="mi">8711</span><span class="p">,</span><span class="mi">2677</span><span class="p">},{</span><span class="mi">-2045</span><span class="p">,</span><span class="mi">5514</span><span class="p">},{</span><span class="mi">-5871</span><span class="p">,</span><span class="mi">17</span><span class="p">},{</span><span class="mi">-9705</span><span class="p">,</span><span class="mi">2204</span><span class="p">},{</span><span class="mi">6577</span><span class="p">,</span><span class="mi">297</span><span class="p">},{</span><span class="mi">7771</span><span class="p">,</span><span class="mi">6640</span><span class="p">},{</span><span class="mi">-1002</span><span class="p">,</span><span class="mi">-3492</span><span class="p">},{</span><span class="mi">-2487</span><span class="p">,</span><span class="mi">-9394</span><span class="p">},{</span><span class="mi">6992</span><span class="p">,</span><span class="mi">-3892</span><span class="p">},{</span><span class="mi">9585</span><span class="p">,</span><span class="mi">-9475</span><span class="p">},{</span><span class="mi">8108</span><span class="p">,</span><span class="mi">6050</span><span class="p">},{</span><span class="mi">-9513</span><span class="p">,</span><span class="mi">-5036</span><span class="p">},{</span><span class="mi">-9110</span><span class="p">,</span><span class="mi">750</span><span class="p">},{</span><span class="mi">-1192</span><span class="p">,</span><span class="mi">1627</span><span class="p">},{</span><span class="mi">9879</span><span class="p">,</span><span class="mi">-9908</span><span class="p">},{</span><span class="mi">-4519</span><span class="p">,</span><span class="mi">-2218</span><span class="p">},{</span><span class="mi">-6230</span><span class="p">,</span><span class="mi">6680</span><span class="p">},{</span><span class="mi">-9091</span><span class="p">,</span><span class="mi">7684</span><span class="p">},{</span><span class="mi">-6892</span><span class="p">,</span><span class="mi">4007</span><span class="p">},{</span><span class="mi">9652</span><span class="p">,</span><span class="mi">6787</span><span class="p">}};</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Solution</span><span class="o">::</span><span class="n">minCostConnectPoints</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="primkruskal">
<h2>Prim算法和Kruskal算法的区别<a class="headerlink" href="#primkruskal" title="此标题的永久链接">¶</a></h2>
<p>Prim算法和Kruskal算法都是用于求解最小生成树的经典算法，它们的主要区别在于实现方式和时间复杂度。</p>
<p>Prim算法是一种贪心算法，其基本思想是从一个任意选定的起始节点开始，每次选择与当前生成树相邻的最短边的另一个端点加入到生成树中，直到所有节点都被加入到生成树中为止。该算法可以使用堆优化的方式，时间复杂度为O(ElogV)，其中E和V分别为边数和顶点数。</p>
<p>Kruskal算法也是一种贪心算法，其基本思想是将所有边按照权值从小到大排序，然后逐步加入边，如果加入某条边会形成环，则舍弃该边，直到所有节点都被加入到生成树中为止。该算法使用并查集来判断是否形成环，时间复杂度为O(ElogE)，其中E为边数。</p>
<p>因此，Prim算法更适用于稠密图（即边数较多），而Kruskal算法更适用于稀疏图（即边数较少）。此外，Prim算法的空间复杂度比Kruskal算法小，因为Prim算法只需要存储每个节点到生成树的最短距离，而Kruskal算法需要存储每个节点所在的集合。</p>
</section>
<section id="id9">
<h2>参考<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h2>
<p>[0] Prim’s algorithm https://en.wikipedia.org/wiki/Prim%27s_algorithm</p>
<p>[1] leetcode 1584. 连接所有点的最小费用 https://leetcode.cn/problems/min-cost-to-connect-all-points/description/</p>
<p>[2] 计程车几何（Taxicab geometry）或曼哈顿距离 https://en.wikipedia.org/wiki/Taxicab_geometry</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Hello</a></h1>








<h3>导航</h3>
<p class="caption" role="heading"><span class="caption-text">Development1</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">leetcode</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="001union_find.html">并查集</a></li>
<li class="toctree-l2"><a class="reference internal" href="002union_find_kruskal.html">Kruskal算法</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Prim算法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#leetcode-1584">leetcode 1584. 连接所有点的最小费用</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">题解</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prim-0">1. 确认初始顶点，Prim算法并没有规定初始点怎么选，这里可以任选，默认取索引为0的点</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">2. 确认下一个连接点，在当前已经确定的点中查找最小边来确认新的点</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id3">2.1 曼哈顿距离计算，这一步可以提前算好存到一个预计算距离数组中，以便提升程序执行速度（空间换时间）</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id4">2.2 在已连接的点集中查找最小边</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id5">2.3 确认全部最小路径</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#o-n-3">3. 优化，上面的时间复杂度已经达到O(n^3)级别了，执行速度有点一言难尽</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#min-cost">3.1 这里增加一个min_cost数组用来存剩余节点距离当前节点的最短距离</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id6">3.2 依据min_cost数据来查找最小边</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id7">3.3 渐进式更新min_cost数组</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id8">4. 完整代码</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#primkruskal">Prim算法和Kruskal算法的区别</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dp/index.html">动态规划</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">leetcode</a><ul>
      <li>Previous: <a href="002union_find_kruskal.html" title="上一章">Kruskal算法</a></li>
      <li>Next: <a href="dp/index.html" title="下一章">动态规划</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, Weekend.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/leetcode/003prim.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>